{% extends "base.html" %}
{% load static %}
{% block title %}<title>Traiter Demande congé</title>{% endblock %}
{% block content %}


<div class="card-body">

    <table class="table table-striped ">
<tr>
<th>date demande</th>
<th>Nom employe</th>    
<th>Type conge</th>
<th>Date début</th>
<th>Date Fin</th>
<th>Durée</th>
<th>Solde congé Annuel</th>
<th>Solde congé Maladie</th>
<th>Refuser ?</th>
<th>Accepter ?</th>
</tr> 
{% for index, ab in dde %}  
<tr>
    <tr>
        <td>{{ab.DateDemande}}</td>
        <td>{{ab.employee.user.first_name}}</td>
        <td>{{ab.type_conge}}</td>
        <td>{{ab.DateDebut}}</td>
        <td>{{ab.DateFin}}</td>
        <td>{{ab.duree}}</td>
        <td>{{ab.employee.nbrEmp.last.solde_conge}}</td>
        <td>{{ab.employee.nbrEmp.last.solde_conge_maladie}}</td>
        <td><a class="cinfirma" href="{% url 'admi:conge_repondre' ab.id 'ref' %}">Refuser</a></td>
        <td><a class="confirma" href="{% url 'admi:conge_repondre' ab.id 'acc' %}">Accepter</a></td>
    </tr>
    
{% endfor %}
</table></div>

</div>



<script>
    document.addEventListener('DOMContentLoaded', function () {
        let linksRefuser = document.querySelectorAll('.cinfirma');
        let linksAccepter = document.querySelectorAll('.confirma');

        for (let link of linksRefuser) {
            link.addEventListener('click', function (event) {
                event.preventDefault();
                let accepted = confirm("Etes-vous sûr de vouloir refuser cette demande?");
                if (accepted) {
                    window.location.href = link.href;
                }
            });
        }

        for (let link of linksAccepter) {
            link.addEventListener('click', function (event) {
                event.preventDefault();
                let accepted = confirm("Etes-vous sûr de vouloir accepter cette demande?");
                if (accepted) {
                    window.location.href = link.href;
                }
            });
        }
    });
</script>



{% endblock %}